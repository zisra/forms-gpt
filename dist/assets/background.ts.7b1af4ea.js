let l=!1;function m(i){const n=`Answer the following multiple choice question. Only give me the answer to the question below without any other text. Keep in mind that this may or may not be multiple choice:
${i.replace(/\d+ points/,"")}`;return console.log(`[Prompt]: ${n}`),n}chrome.storage.local.get(["apiKey"],({apiKey:i})=>{if(!i)return;async function n(c){try{const o=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({model:"gpt-3.5-turbo",messages:[{role:"user",content:m(c)}],max_tokens:150,temperature:.5})}),{error:t,choices:r}=await o.json();if(t)throw new Error(t.message);const s=r[0].message.content;console.log(`[Answer]: ${s}`),chrome.tabs.query({active:!0,currentWindow:!0},u=>{chrome.scripting.executeScript({target:{tabId:u[0].id},func:d=>{const e=document.createElement("div");e.innerText=d,e.id="answer",e.style.position="fixed",e.style.fontSize="12px",e.style.bottom="10px",e.style.left="10px",e.style.backgroundColor="#323232",e.style.padding="10px",e.style.border="1px solid black",e.style.borderRadius="2px",e.style.color="#323232",e.style.opacity="0.1",e.addEventListener("mouseover",()=>{e.style.color="white"}),e.addEventListener("mouseout",()=>{e.style.color="#323232"}),document.body.appendChild(e);const a=()=>{e.remove(),document.removeEventListener("click",a)};document.addEventListener("click",a)},args:[s]})})}catch(o){if(o instanceof Error)throw new Error(o.message)}}l||(chrome.contextMenus.create({id:"execute-request",title:"Execute Request",contexts:["selection"]}),l=!0,chrome.contextMenus.onClicked.addListener((c,o)=>{c.menuItemId==="execute-request"&&chrome.scripting.executeScript({target:{tabId:o.id},func:()=>window.getSelection().toString()},t=>{const r=t[0].result.toString();n(r)})})),chrome.commands.onCommand.addListener(c=>{c==="execute-request"&&chrome.tabs.query({active:!0,currentWindow:!0},o=>{chrome.scripting.executeScript({target:{tabId:o[0].id},func:()=>{var t;return(t=window.getSelection())==null?void 0:t.toString()}},t=>{const r=t[0].result;if(!r)throw new Error("No text selected");n(r)})})})});
